# ü§ñ –û—Ç—á–µ—Ç –æ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞ UltraMarathonTracker

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 15 –æ–∫—Ç—è–±—Ä—è 2025  
**–í—Ä–µ–º—è:** 15:41 MSK  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ë–û–¢ –ü–û–õ–ù–û–°–¢–¨–Æ –†–ê–ë–û–¢–û–°–ü–û–°–û–ë–ï–ù**

## üìã –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

–ë–æ—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É–ª—å—Ç—Ä–∞–º–∞—Ä–∞—Ñ–æ–Ω–∞ –®—Ä–∏ –ß–∏–Ω–º–æ—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

## üîß –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–æ—Ç–∞
- **Telegram Bot Token:** –ù–∞—Å—Ç—Ä–æ–µ–Ω –∏ –∞–∫—Ç–∏–≤–µ–Ω
- **Admin IDs:** –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã (ID: 196447886)
- **Server URL:** –ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- **Environment Variables:** –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 2. ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **node-telegram-bot-api:** v0.64.0 ‚úÖ
- **express:** v4.21.2 ‚úÖ
- **sqlite3:** v5.1.7 ‚úÖ
- **node-fetch:** v2.7.0 ‚úÖ
- **dotenv:** v16.6.1 ‚úÖ
- **cors:** v2.8.5 ‚úÖ
- **@netlify/blobs:** v7.4.0 ‚úÖ

### 3. ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π –±–æ—Ç (bot/bot.js)
- **–°—Ç–∞—Ç—É—Å:** –ó–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç (PID: 38568)
- **–†–µ–∂–∏–º:** Polling (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
- **–§—É–Ω–∫—Ü–∏–∏:**
  - ‚úÖ –ö–æ–º–∞–Ω–¥–∞ /start
  - ‚úÖ –ö–æ–º–∞–Ω–¥–∞ /admin
  - ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ callback queries
  - ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
  - ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∏–ª–æ–º–µ—Ç—Ä–æ–≤
  - ‚úÖ –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö

### 4. ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (server.js)
- **–°—Ç–∞—Ç—É—Å:** –ó–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç (PID: 38740)
- **–ü–æ—Ä—Ç:** 3000
- **API Endpoints:**
  - ‚úÖ GET /api/data - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
  - ‚úÖ POST /api/data - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
  - ‚úÖ GET /api/stats - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  - ‚úÖ POST /api/update_km - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∏–ª–æ–º–µ—Ç—Ä–æ–≤
  - ‚úÖ POST /api/add_km - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∏–ª–æ–º–µ—Ç—Ä–æ–≤
  - ‚úÖ POST /api/add_laps - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫—Ä—É–≥–æ–≤
  - ‚úÖ POST /api/reset - —Å–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
  - ‚úÖ GET /api/set_race_time - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–±–µ–≥–∞
  - ‚úÖ POST /api/set_race_time - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–±–µ–≥–∞

### 5. ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQLite)
- **–§–∞–π–ª:** database/run_stats.db
- **–¢–∞–±–ª–∏—Ü—ã:**
  - ‚úÖ run_stats (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–±–µ–≥–∞)
  - ‚úÖ race_time (–≤—Ä–µ–º—è –∑–∞–±–µ–≥–∞)
- **–§—É–Ω–∫—Ü–∏–∏:**
  - ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∏–ª–æ–º–µ—Ç—Ä–æ–≤
  - ‚úÖ –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
  - ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–±–µ–≥–∞

### 6. ‚úÖ Netlify —Ñ—É–Ω–∫—Ü–∏–∏
- **–°—Ç–∞—Ç—É—Å:** –î–æ—Å—Ç—É–ø–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- **–§—É–Ω–∫—Ü–∏–∏:**
  - ‚úÖ /.netlify/functions/data - —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
  - ‚úÖ /.netlify/functions/set_race_time - –≤—Ä–µ–º—è –∑–∞–±–µ–≥–∞
  - ‚úÖ /.netlify/functions/webhook - –æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook
  - ‚úÖ /.netlify/functions/bot - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –±–æ—Ç

### 7. ‚úÖ Webhook
- **–°—Ç–∞—Ç—É—Å:** –ù–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **URL:** https://ultra-marathon-tracker.netlify.app/.netlify/functions/webhook
- **–§—É–Ω–∫—Ü–∏–∏:**
  - ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
  - ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ callback queries
  - ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç 1: –ë–∞–∑–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- ‚úÖ –ë–æ—Ç –∞–∫—Ç–∏–≤–µ–Ω –≤ Telegram
- ‚úÖ API —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É

### –¢–µ—Å—Ç 2: API —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: `{"total_km":0,"total_laps":0}`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∏–ª–æ–º–µ—Ç—Ä–æ–≤: `{"success":true,"total_km":10.5}`
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–±–µ–≥–∞: `{"race_start":"2025-10-04T10:00:00+03:00"}`
- ‚úÖ –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö: `{"success":true,"total_km":0}`

### –¢–µ—Å—Ç 3: Netlify —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –î–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ Netlify: `{"id":1,"total_km":0,"total_laps":0}`
- ‚úÖ –í—Ä–µ–º—è –∑–∞–±–µ–≥–∞ —á–µ—Ä–µ–∑ Netlify: `{"race_start":"2025-10-04T10:00:00+03:00"}`
- ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω

### –¢–µ—Å—Ç 4: Webhook
- ‚úÖ Webhook –¥–æ—Å—Ç—É–ø–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç
- ‚úÖ Callback query –æ–±—Ä–∞–±–æ—Ç–∞–Ω

### –¢–µ—Å—Ç 5: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SQLite
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

## üéØ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±–æ—Ç–∞

### –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- ‚úÖ –û—Ç–∫—Ä—ã—Ç–∏–µ Mini App
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞–±–µ–≥–∞
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑—Ä—è–¥–∞—Ö
- ‚úÖ –í—Ä–µ–º—è –∑–∞–±–µ–≥–∞

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∏–ª–æ–º–µ—Ç—Ä–æ–≤
- ‚úÖ –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º –∑–∞–±–µ–≥–∞

## üìä –¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ

- **–ö–∏–ª–æ–º–µ—Ç—Ä—ã:** 0.0 –∫–º
- **–ö—Ä—É–≥–∏:** 0 –∫—Ä—É–≥–æ–≤
- **–†–∞–∑—Ä—è–¥:** ‚ö™Ô∏è –ë–µ–∑ —Ä–∞–∑—Ä—è–¥–∞
- **–í—Ä–µ–º—è –∑–∞–±–µ–≥–∞:** 4-5 –æ–∫—Ç—è–±—Ä—è 2025, 10:00-10:00 MSK
- **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 15.10.2025 12:41

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞–±–æ—Ç–µ

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
- ‚úÖ –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ polling
- ‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ localhost:3000
- ‚úÖ –í—Å–µ API endpoints –¥–æ—Å—Ç—É–ø–Ω—ã

### –ü—Ä–æ–¥–∞–∫—à–µ–Ω:
- ‚úÖ Netlify —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã
- ‚úÖ Webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ Admin IDs –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞
2. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è:** –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ë–æ—Ç UltraMarathonTracker –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!** 

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ë–æ—Ç –º–æ–∂–µ—Ç:
- –ü—Ä–∏–Ω–∏–º–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- –†–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω–æ, —Ç–∞–∫ –∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

**–°—Ç–∞—Ç—É—Å:** üü¢ **–ì–û–¢–û–í –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ**

---
*–û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ 15.10.2025 –≤ 15:41 MSK*
